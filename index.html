<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit JSON File on Google Drive</title>
</head>
<body>
    <h1>Edit JSON File on Google Drive</h1>

    <button onclick="loadFileFromDrive()">Load JSON File</button>
    <textarea id="jsonTextArea" rows="10" cols="50"></textarea>
    <button onclick="saveFileToDrive()">Save JSON File</button>

    <script>
        // Client ID and API key from the Developer Console
        const CLIENT_ID = 'YOUR_CLIENT_ID';
        const API_KEY = 'YOUR_API_KEY';

        // Authorization scopes required by the API
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';

        let accessToken;

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],
                scope: SCOPES
            }).then(() => {
                gapi.auth2.getAuthInstance().signIn().then(updateSigninStatus);
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                accessToken = gapi.auth.getToken().access_token;
                console.log("Access token:", accessToken);
            } else {
                console.log("Sign-in failed.");
            }
        }

        function loadFileFromDrive() {
            gapi.client.drive.files.list({
                q: "name='YOUR_FILE_NAME.json'"
            }).then(response => {
                const file = response.result.files[0];
                const fileId = file.id;

                gapi.client.drive.files.get({
                    fileId: fileId,
                    alt: 'media'
                }).then(response => {
                    document.getElementById('jsonTextArea').value = JSON.stringify(response.result, null, 2);
                });
            });
        }

        function saveFileToDrive() {
            const content = document.getElementById('jsonTextArea').value;
            const blob = new Blob([content], { type: 'application/json' });

            const metadata = {
                name: 'YOUR_FILE_NAME.json',
                mimeType: 'application/json'
            };

            const form = new FormData();
            form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
            form.append('file', blob);

            fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&access_token=' + accessToken, {
                method: 'POST',
                body: form
            }).then(response => {
                console.log('File saved successfully:', response);
            }).catch(error => {
                console.error('Error saving file:', error);
            });
        }
    </script>
    <script src="https://apis.google.com/js/api.js?onload=handleClientLoad" async defer></script>
</body>
</html>
